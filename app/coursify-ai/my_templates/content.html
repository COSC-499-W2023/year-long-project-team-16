<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Content - Coursify.ai</title>

    <!-- Icons -->
    <link
      href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css"
      rel="stylesheet"
    />

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;400;500&display=swap"
      rel="stylesheet"
    />

    <!-- Main Stylesheet -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <div class="link_container">
        <a href="{{ url_for('index') }}"
          ><img src="{{ url_for('static', filename='cap_logo1.png') }}" alt="Coursify.ai Logo" id="logo"
        /></a>
      </div>

      <nav class="navbar">
        <div id="sidebar">
          <a href="{{ url_for('index') }}" id = "home">HOME</a>
          <a href="{{ url_for('my_content') }}" id = "content">MY CONTENT</a>
          <a href="ai.html" id = "ai">AI ASSISTANT</a>
          <a href="{{ url_for('reviews') }}">REVIEW</a>
          <a href="settings.html" id = "settings">SETTINGS</a>
          <a href="{{ url_for('logout') }}" id="logout">LOGOUT</a>

        </div>
      </nav>
      <i class="bx bx-menu"></i>
    </header>

    <!-- My Content Section -->
    <!-- <section id="my-content">
      <div class="content-header">
        <h1 id = "title">My Notes</h1>
      </div>
      <div class="notes-container"> -->
        <!-- Note Cards -->
        <!-- <div class="note-card">
          <div class="note-title">Note Title 1</div>
          <div class="note-summary">Brief summary of the note...</div>
          <button class="download-btn">Download</button>
        </div>
        <div class="note-card">
          <div class="note-title">Note Title 1</div>
          <div class="note-summary">Brief summary of the note...</div>
          <button class="download-btn">Download</button>
        </div>
        <div class="note-card">
          <div class="note-title">Note Title 1</div>
          <div class="note-summary">Brief summary of the note...</div>
          <button class="download-btn">Download</button>
        </div>
        <div class="note-card">
          <div class="note-title">Note Title 1</div>
          <div class="note-summary">Brief summary of the note...</div>
          <button class="download-btn">Download</button>
        </div>
        <div class="note-card">
          <div class="note-title">Note Title 1</div>
          <div class="note-summary">Brief summary of the note...</div>
          <button class="download-btn">Download</button>
        </div>
        <div class="note-card">
          <div class="note-title">Note Title 1</div>
          <div class="note-summary">Brief summary of the note...</div>
          <button class="download-btn">Download</button>
        </div>
        <div class="note-card">
          <div class="note-title">Note Title 1</div>
          <div class="note-summary">Brief summary of the note...</div>
          <button class="download-btn">Download</button>
        </div>
        <div class="note-card">
          <div class="note-title">Note Title 1</div>
          <div class="note-summary">Brief summary of the note...</div>
          <button class="download-btn">Download</button>
        </div> -->
        <!-- Repeat for more note cards -->
        <!-- Add more cards as needed -->
      <!-- </div>
    </section> -->

    <!-- <section id="my-content">
      <div class="content-header">
        <h1 id = "title">My Notes</h1>
      </div>
      <div class="notes-container"> -->
        <!-- Note Cards -->
        <!-- {% for file in file_data %}
        <div class="note-card">
          <div class="note-title">{{ file.filename }}</div>
          <div class="note-summary">Click download to view the PDF...</div>
          <a href="{{ url_for('get_pdf', filename=file.filename) }}" class="download-btn">Download</a> -->
          <!-- Share Button -->
      <!-- <button onclick="showForm('{{ file._id }}')" class="share-btn">Share</button>
    </div>
    {% endfor %}
  </div>
</section> -->



<!-- Share Form -->
<!-- <div id="shareForm" style="display: none;">
  <form action="{{ url_for('share_via_email') }}" method="post">
    <input type="hidden" id="fileId" name="file_id">
    <label for="email">Recipient's Email:</label>
    <input type="email" id="email" name="email" required>
    <input type="submit" value="Share">
  </form>
</div> -->
<section id="my-content">
  <div class="content-header">
    <h1 id = "title">My Notes</h1>
  </div>
  <div class="notes-container">
    <div class="notes-list">
      <!-- Note Cards -->
      {% for file in file_data %}
      <div class="note-card" onclick="showDetails('{{ file._id }}', '{{ file.filename }}')">
        <div class="note-title">{{ file.filename }}</div>
      </div>
      {% endfor %}
    </div>
    <div id="note-details" style="display:none;">
      <div class="note-content">
        <div class="note-title" id="detailTitle"></div>
        <div class="note-summary">Click download to view the PDF...</div>
        <a href="" id="downloadLink" class="download-btn">Download</a>
        <button onclick="showForm()" id="shareButton" class="share-btn">Share</button>
        <form action="" method="post" id="deleteForm" onsubmit="return confirm('Are you sure you want to delete this file ?');">
          <button type="submit" class="delete-btn">Delete</button>
        </form>  
      </div>
        <!-- <button onclick="showReviewForm(document.getElementById('reviewFileId').value, document.getElementById('reviewFilename').value)" id="reviewButton" class="review-btn">Review</button> -->
      </div> 
    </div>
  </div>
</section>
<!-- Share Form -->
<div id="shareForm" style="display: none;">
  <form action="{{ url_for('share_via_email') }}" method="post">
    <input type="hidden" id="fileId" name="file_id">
    <label for="email">Recipient's Email:</label>
    <input type="email" id="email" name="email" required>
    <input type="submit" value="Share">
  </form>
</div>

<!--review form-->
<!-- <div id="reviewForm" style="display: none;">
  <form action="{{ url_for('submit_review') }}" method="post">
    <input type="hidden" id="reviewFileId" name="file_id">
    <input type="hidden" id="reviewFilename" name="filename">
    <label for="reviewText">Your Review:</label>
    <textarea id="reviewText" name="review_text" required></textarea>
    <input type="submit" value="Submit Review">
  </form>
</div> -->


<script>
document.getElementById('shareButton').addEventListener('click', function() {
  document.getElementById('shareForm').scrollIntoView({behavior: "smooth"});
});
//function showDetails(id, filename) {
  //document.getElementById('detailTitle').textContent = filename;
  /*document.getElementById('downloadLink').href = "{{ url_for('get_pdf', filename='') }}" + filename;*/
  //document.getElementById('downloadLink').addEventListener('click', function(event) {
    // Prevent the default action
    //event.preventDefault();

    // Create two 'a' elements with the href set to the download URLs
    //var pdfLink = document.createElement('a');
    //pdfLink.href = "{{ url_for('get_pdf', filename='') }}" + filename;
    //pdfLink.download = filename;

    //var presentationLink = document.createElement('a');
    //presentationLink.href = "{{ url_for('get_presentation', filename='') }}" + filename;
    //presentationLink.download = filename;

    // Append the 'a' elements to the body
    //document.body.appendChild(pdfLink);
    //document.body.appendChild(presentationLink);

    // Programmatically click the 'a' elements to start the download
    //pdfLink.click();
    //presentationLink.click();

    // Clean up by removing the 'a' elements from the body
    //document.body.removeChild(pdfLink);
    //document.body.removeChild(presentationLink);
//});
  // Get the downloadLink button
  //var downloadLink = document.getElementById('downloadLink');

  // Remove any existing event listeners
  //var newDownloadLink = downloadLink.cloneNode(true);
  //downloadLink.parentNode.replaceChild(newDownloadLink, downloadLink);

  //newDownloadLink.addEventListener('click', function(event) {
    // Prevent the default action
  //  event.preventDefault();

    // Create two 'a' elements with the href set to the download URLs
  //  var pdfLink = document.createElement('a');
  //  pdfLink.href = "{{ url_for('get_pdf', filename='') }}" + filename;
  //  pdfLink.download = filename;

  //  var presentationLink = document.createElement('a');
  //  presentationLink.href = "{{ url_for('get_presentation', filename='') }}" + filename;
  //  presentationLink.download = filename;

    // Append the 'a' elements to the body
  //  document.body.appendChild(pdfLink);
  //  document.body.appendChild(presentationLink);

    // Programmatically click the 'a' elements to start the download
  //  pdfLink.click();
  //  presentationLink.click();

    // Clean up by removing the 'a' elements from the body
  //  document.body.removeChild(pdfLink);
  //  document.body.removeChild(presentationLink);
 // });

  //document.getElementById('note-details').style.display = 'block';
  //document.getElementById('deleteForm').action = '/delete/' + id;
//}
function showDetails(id, filename) {
  document.getElementById('detailTitle').textContent = filename;

  // Get the downloadLink button
  var downloadLink = document.getElementById('downloadLink');

  // Remove any existing event listeners
  var newDownloadLink = downloadLink.cloneNode(true);
  downloadLink.parentNode.replaceChild(newDownloadLink, downloadLink);

  newDownloadLink.addEventListener('click', function(event) {
    // Prevent the default action
    event.preventDefault();

    // Create two 'a' elements with the href set to the download URLs
    var pdfLink = document.createElement('a');
    pdfLink.href = "{{ url_for('get_pdf', filename='') }}" + filename;
    pdfLink.download = filename;

    var presentationLink = document.createElement('a');
    presentationLink.href = "{{ url_for('get_presentation', filename='') }}" + filename;
    presentationLink.download = filename;

    // Append the 'a' elements to the body
    document.body.appendChild(pdfLink);
    document.body.appendChild(presentationLink);

    // Programmatically click the 'a' elements to start the download
    pdfLink.click();
    presentationLink.click();

    // Clean up by removing the 'a' elements from the body
    document.body.removeChild(pdfLink);
    document.body.removeChild(presentationLink);
  });

  document.getElementById('note-details').style.display = 'block';
  document.getElementById('deleteForm').action = '/delete/' + id;

  // Set the onclick attribute of the "Share" button to call the showForm function with the correct file id
  document.getElementById('shareButton').onclick = function() { showForm(id); };
}

function showForm(fileId) {
  // Show the form
  document.getElementById('shareForm').style.display = 'block';
  
  // Set the file's ID in the form
  document.getElementById('fileId').value = fileId;
}

window.onload = function() {
  var noteCards = document.getElementsByClassName('note-card');

// Add click event listener to each note card
for (var i = 0; i < noteCards.length; i++) {
    noteCards[i].addEventListener('click', function() {
        // Remove 'clicked' class from all note cards
        for (var j = 0; j < noteCards.length; j++) {
            noteCards[j].classList.remove('clicked');
        }
        // Add 'clicked' class to the clicked note card
        this.classList.add('clicked');
});
}}
//function showReviewForm(id, filename) {
  // Set the file id and filename in the form
  //document.getElementById('reviewFileId').value = fileId;
  //document.getElementById('reviewFilename').value = filename;

  // Show the form
  //document.getElementById('reviewForm').style.display = 'block';
//}
</script>

    <footer id="footer">&copy; 2023 CoursifyAI. All rights reserved.</footer>
  </body>
</html>